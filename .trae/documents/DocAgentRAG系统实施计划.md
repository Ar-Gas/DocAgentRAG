# 办公文档智能分类与检索系统实施计划

## 项目结构搭建

1. 创建基础目录结构：

   * /root/autodl-tmp/doc/：存储上传文档（利用数据盘空间）

   * /root/autodl-tmp/model/：存储从ModelScope下载的AI模型

   * /root/autodl-tmp/static/：存储前端静态资源

   * /root/autodl-tmp/frontend/：前端Vue 3项目

   * /root/autodl-tmp/backend/：后端FastAPI项目

## 前端开发

1. **项目初始化**：

   * 使用Vite创建Vue 3项目

   * 配置Vue Router、Pinia、Axios

   * 设置请求拦截器，确保与后端接口兼容

2. **核心组件开发**：

   * **文档上传组件**：支持单个/批量上传，限制格式（PDF、Word、Excel、邮件），显示上传进度和状态

   * **文档预览组件**：展示已上传文档的基础信息（文件名、格式、上传时间），支持简单文本预览

   * **分类交互组件**：实现"一键分类"按钮，调用后端分类接口，展示分类结果

   * **检索组件**：开发搜索框，支持回车检索，调用后端检索接口

   * **结果展示组件**：展示分类目录层级和检索结果，支持按匹配度和上传时间排序

3. **交互优化**：

   * 添加错误提示（上传失败、分类失败、检索失败）

   * 添加加载动画，提升用户体验

   * 确保页面自适应PC端浏览器

4. **部署配置**：

   * 将前端构建产物部署到/root/autodl-tmp/static/目录

   * 使用已开放的6006端口提供前端静态服务

## 后端开发

1. **基础配置**：

   * 初始化FastAPI项目

   * 配置服务器端口为6008（已开放），设置跨域支持

   * 创建主程序入口（main.py）

2. **文档内容提取**：

   * **PDF提取**：使用MinerU工具提取文本信息，过滤无效空格、乱码等冗余内容

   * **Word提取**：使用python-docx提取正文和标题信息

   * **Excel提取**：使用pandas + openpyxl提取表格数据，转为文本格式

   * **邮件提取**：使用email包提取邮件正文、发件人、收件人、发送时间等核心信息

   * **统一封装**：将上述提取函数封装为通用接口

3. **数据存储**：

   * **本地文件存储**：保存上传文档到/root/autodl-tmp/doc/文件夹，按"原文件名+时间戳"命名

   * **JSON存储**：存储文档重点信息、分类结果、分类目录

   * **Chroma向量数据库**：存储文档全文向量和文件名向量，支持向量匹配检索

4. **AI模型集成**：

   * 从ModelScope下载模型：

     * ernie-3.0-base-zh：用于文档分类

     * chinese-ocr-lite：用于OCR文本提取

     * text2vec-base-chinese：用于生成文档向量

   * 封装模型调用逻辑，集成RAG和OCR

   * 利用已有的PyTorch 2.8.0和CUDA 12.8环境运行模型

5. **接口开发**：

   * **文档上传接口**：接收前端上传的文件，保存至doc文件夹

   * **文档信息接口**：返回文档基础信息和提取的文本内容

   * **分类触发接口**：触发AI分类流程，返回分类状态和目录

   * **分类目录接口**：返回分类目录数据

   * **检索接口**：接收关键词，进行文件名+文档内容双重检索，返回结果

## 环境配置

1. **依赖安装**：

   * 前端：Vue 3及相关依赖

   * 后端：FastAPI、文档提取工具（MinerU、python-docx、pandas、openpyxl）、Chroma向量数据库

   * 利用已有的Python 3.12环境

2. **一键部署脚本**：

   * 创建部署脚本，自动安装依赖、配置环境

   * 配置服务器系统参数，优化性能

3. **一键运行脚本**：

   * 配置局域网访问，自动绑定服务器局域网IP

   * 使用6006端口提供前端服务，6008端口提供后端服务

   * 输出可访问URL，供局域网内设备访问

   * 处理端口冲突，自动切换备用端口

## 测试验证

1. **测试文件生成**：

   * 生成各类测试文档：PDF（10份）、Word（10份）、Excel（8份）、邮件（5份）

   * 文档内容涵盖学术资料、办公通知、报表、会议纪要等场景

2. **分类效果测试**：

   * 测试分类准确率，要求不低于90%

   * 检查分类目录生成的规范性

3. **检索性能测试**：

   * 测试检索效率：单条关键词检索响应时间不超过1秒

   * 测试召回率：要求不低于88%

   * 测试准确率：要求不低于90%

4. **内存占用测试**：

   * 监控系统内存占用，确保在合理范围

   * 利用已有的12GB GPU内存和45GB系统内存，优化内存使用

## 技术要点

* 充分利用已有的PyTorch 2.8.0和CUDA 12.8环境，无需重新安装

* 将数据存储在/root/autodl-tmp目录下，利用数据盘的50GB空间

* 使用已开放的6006和6008端口部署前端和后端服务

* 优先使用轻量化模型和云端API调用，减少内存占用

* 确保局域网访问配置正确，支持多设备访问

* 优化数据存储和检索性能，提升用户体验

* 完善错误处理和异常情况应对，确保系统稳定性

